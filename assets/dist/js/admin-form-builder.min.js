/*!
 * Torro Forms Version 1.0.0-beta.8 (http://torro-forms.com)
 * Licensed under GNU General Public License v3 (http://www.gnu.org/licenses/gpl-3.0.html)
 */
window.torro=window.torro||{},function(e,t,i,n,o,s){"use strict";function d(e){r++,c["builder"+r]=[],this.instanceNumber=r,this.$el=t(e)}var l,r=0,u=[],c={};i.extend(d.prototype,{elementTypes:void 0,form:void 0,containers:void 0,elements:void 0,elementChoices:void 0,elementSettings:void 0,init:function(){return this.$el.length?void e.api.init().done(i.bind(function(){(new e.api.collections.ElementTypes).fetch({data:{context:"edit"},context:this,success:function(n){this.elementTypes=e.Builder.ElementTypes.fromApiCollection(n),"auto-draft"!==t("#original_post_status").val()?new e.api.models.Form({id:parseInt(t("#post_ID").val(),10)}).fetch({data:{context:"edit",_embed:!0},context:this,success:function(e){t(document).ready(i.bind(function(){var t;u.push(this.instanceCount),this.setupInitialData(e.attributes),this.setupViews();for(t in c["builder"+this.instanceCount])c["builder"+this.instanceCount][t](this);delete c["builder"+this.instanceCount]},this))},error:function(){t(document).ready(i.bind(function(){this.fail(s.couldNotLoadData)},this))}}):t(document).ready(i.bind(function(){var e;u.push(this.instanceCount),this.setupInitialData(),this.setupViews();for(e in c["builder"+this.instanceCount])c["builder"+this.instanceCount][e](this);delete c["builder"+this.instanceCount]},this))},error:function(){t(document).ready(i.bind(function(){this.fail(s.couldNotLoadData)},this))}})},this)).fail(i.bind(function(){t(document).ready(i.bind(function(){this.fail(s.couldNotLoadData)},this))},this)):void console.error(s.couldNotInitCanvas)},setupInitialData:function(t){i.contains(u,this.instanceCount)&&(t?(this.form=new e.Builder.FormModel(t),t._embedded.containers&&t._embedded.containers[0]?this.containers=new e.Builder.ContainerCollection(t._embedded.containers[0]):this.containers=new e.Builder.ContainerCollection,t._embedded.elements&&t._embedded.elements[0]?this.elements=new e.Builder.ElementCollection(t._embedded.elements[0]):this.elements=new e.Builder.ElementCollection,t._embedded.element_choices&&t._embedded.element_choices[0]?this.elementChoices=new e.Builder.ElementChoiceCollection(t._embedded.element_choices[0]):this.elementChoices=new e.Builder.ElementChoiceCollection,t._embedded.element_settings&&t._embedded.element_settings[0]?this.elementSettings=new e.Builder.ElementSettingCollection(t._embedded.element_settings[0]):this.elementSettings=new e.Builder.ElementSettingCollection):(this.form=new e.Builder.FormModel,this.containers=new e.Builder.ContainerCollection([{form_id:this.form.get("id"),label:s.defaultContainerLabel.replace("%s","1")}]),this.elements=new e.Builder.ElementCollection,this.elementChoices=new e.Builder.ElementChoiceCollection,this.elementSettings=new e.Builder.ElementSettingCollection))},setupViews:function(){!i.contains(u,this.instanceCount)},onLoad:function(e){return i.isUndefined(c["builder"+this.instanceCount])?void e(this):void c["builder"+this.instanceCount].push(e)},fail:function(t){var i=e.template("failure");this.$el.find(".drag-drop-area").addClass("is-empty").html(i({message:t}))}}),e.Builder=d,e.Builder.getInstance=function(){return l||(l=new d("#torro-form-canvas"),l.init()),l}}(window.torro,window.jQuery,window._,window.Backbone,window.wp,window.torroBuilderI18n),function(e,t,i,n){"use strict";e.BaseModel=n.Model.extend({links:{},constructor:function(e,o){var s=e||{},d=this.idAttribute||n.Model.prototype.idAttribute||"id";s._links&&(this.links=s._links),s=i.omit(s,["_links","_embedded"]),s[d]||(s[d]=t.generateTempId()),n.Model.apply(this,[s,o])},sync:function(e,t,n){return"create"===e&&t.has(t.idAttribute)&&(n.attrs||(n.attrs=t.toJSON(n)),n.attrs=i.omit(n.attrs,t.idAttribute)),!1},isNew:function(){return!this.has(this.idAttribute)||t.isTempId(this.get(this.idAttribute))}})}(window.torro.Builder,window.torro,window._,window.Backbone),function(e,t,i,n){"use strict";e.BaseCollection=n.Collection.extend({model:e.BaseModel,initialize:function(){this.urlEndpoint&&(this.url=t.api.root+t.api.versionString+this.urlEndpoint)},sync:function(){return!1}})}(window.torro.Builder,window.torro,window._,window.Backbone),function(e,t){"use strict";function i(e){this.attributes=e}t.extend(i.prototype,{getSlug:function(){return this.attributes.slug},getTitle:function(){return this.attributes.title},getDescription:function(){return this.attributes.description},getIconUrl:function(){return this.attributes.icon_url},isEvaluable:function(){return this.attributes.evaluable},isMultiField:function(){return this.attributes.multifield},getSections:function(){return this.attributes.sections},getFields:function(){return this.attributes.fields}}),e.ElementType=i}(window.torro.Builder,window._),function(e,t){"use strict";function i(e){var t;this.types={};for(t in e)this.types[e[t].getSlug()]=e[t]}t.extend(i.prototype,{get:function(e){if(!t.isUndefined(this.types[e]))return this.types[e]},getAll:function(){return this.types}}),i.fromApiCollection=function(n){var o=[];return n.each(function(i){var n=t.extend({},i.attributes);n._links&&delete n._links,n._embedded&&delete n._embedded,o.push(new e.ElementType(n))}),new i(o)},e.ElementTypes=i}(window.torro.Builder,window._),function(e){"use strict";e.ContainerModel=e.BaseModel.extend({defaults:{id:0,form_id:0,label:"",sort:0}})}(window.torro.Builder),function(e){"use strict";e.ElementChoiceModel=e.BaseModel.extend({defaults:{id:0,element_id:0,field:"",value:"",sort:0}})}(window.torro.Builder),function(e){"use strict";e.ElementModel=e.BaseModel.extend({defaults:{id:0,container_id:0,label:"",sort:0,type:"textfield"}})}(window.torro.Builder),function(e){"use strict";e.ElementSettingModel=e.BaseModel.extend({defaults:{id:0,element_id:0,name:"",value:""}})}(window.torro.Builder),function(e){"use strict";e.FormModel=e.BaseModel.extend({defaults:{id:0,title:"",slug:"",author:0,status:"draft",timestamp:0,timestamp_modified:0}})}(window.torro.Builder),function(e){"use strict";e.ContainerCollection=e.BaseCollection.extend({model:e.ContainerModel,urlEndpoint:"containers"})}(window.torro.Builder),function(e){"use strict";e.ElementChoiceCollection=e.BaseCollection.extend({model:e.ElementChoiceModel,urlEndpoint:"element_choices"})}(window.torro.Builder),function(e){"use strict";e.ElementCollection=e.BaseCollection.extend({model:e.ElementModel,urlEndpoint:"elements"})}(window.torro.Builder),function(e){"use strict";e.ElementSettingCollection=e.BaseCollection.extend({model:e.ElementSettingModel,urlEndpoint:"element_settings"})}(window.torro.Builder),function(e){"use strict";e.FormCollection=e.BaseCollection.extend({model:e.FormModel,urlEndpoint:"forms"})}(window.torro.Builder),function(e){"use strict";e.getInstance()}(window.torro.Builder);