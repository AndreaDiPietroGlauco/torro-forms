/*!
 * Torro Forms Version 1.0.0alpha1 (http://torro-forms.com)
 * Licensed under GNU General Public License v3 (http://www.gnu.org/licenses/gpl-3.0.html)
 */
!function(t,s,a,i){"use strict";function n(t){this.translations=t,this.selectors={participants:"#form-participants",participants_counter:"#form-participants-count",participants_status:"#form-participants-status p",participants_list:"#form-participants-list",participant_sub:".participant",delete_participant_button:".form-delete-participant",add_all_members_button:"#form-add-participants-allmembers-button",remove_all_members_button:".form-remove-all-participants",nothing_found:".no-users-found"}}n.prototype={init:function(){this.refresh_nothing_found();var t=this;a(document).on("click",this.selectors.add_all_members_button,function(){var i=a(this);i.addClass("button-loading"),s.ajax.post("torro_add_participants_allmembers",{nonce:t.translations.nonce_add_participants_allmembers}).done(function(s){var n=a(t.selectors.participants).val();n=n.split(",");var e=0;a.each(s,function(s,i){var r=!1;-1<n.indexOf(i.id)&&(r=!0),0==r&&(n=""===n?i.id:n+","+i.id,a(t.selectors.participants_list).find("tbody").append('<tr class="participant participant-user-'+i.id+' just-added"><td>'+i.id+"</td><td>"+i.user_nicename+"</td><td>"+i.display_name+"</td><td>"+i.user_email+"</td><td>"+t.translations.just_added+'</td><td><a class="button form-delete-participant" rel="'+i.id+'">'+t.translations["delete"]+"</a></td></tr>"),e++)});var r=parseInt(a(t.selectors.participants_counter).val(),10)+e;a(t.selectors.participants).val(n),t.refresh_participants_counter(r),a(t.selectors.participants_list).show(),t.refresh_nothing_found(),i.removeClass("button-loading")}).fail(function(t){console.log(t)})}),a(document).on("click",this.selectors.remove_all_members_button,function(){a(t.selectors.participants).val(""),t.refresh_participants_counter(0),a(t.selectors.participants_list).find(t.selectors.participant_sub).remove(),t.refresh_nothing_found()}),a(document).on("click",this.selectors.delete_participant_button,function(){var s=a(this).attr("rel"),i="",n=a(t.selectors.participants).val();n=n.split(","),a.each(n,function(t,a){a!=s&&(i=""===i?a:i+","+a)}),a(t.selectors.participants).val(i),t.refresh_participants_counter(parseInt(a(t.selectors.participants_counter).val(),10)-1),a(".participant-user-"+s).remove(),t.refresh_nothing_found()})},refresh_participants_counter:function(t){var s=t+" "+this.translations.added_participants;a(this.selectors.participants_status).html(s),a(this.selectors.participants_counter).val(t)},refresh_nothing_found:function(){0<parseInt(a(this.participants_counter).val())?a(this.selectors.nothing_found).hide():a(this.selectors.nothing_found).show()}},t.add_extension("access_control_selected_members",new n(i))}(form_builder,wp,jQuery,translation_sm);